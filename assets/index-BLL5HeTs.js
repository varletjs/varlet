import{ay as O,j as S,aA as j,aB as b,a3 as W,a6 as i,b as T,F as D,m as G,h as P,q as y,P as o,w as z,Q as h,R as L,U as s,p as c,N as V}from"./index-DtCrA0ro.js";import{c as M}from"./elements-C0ey49jB.js";import{c as Y}from"./shared-BLZOSN1R.js";import{A as E}from"./appType-B5zMYMV2.js";const Z="background-image",F="lazy-loading",Q="lazy-error",v="lazy-attempt",$=["scroll","wheel","mousewheel","resize","animationend","transitionend","touchmove"],p="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",l=[],d=[],w=Y(100),e={loading:p,error:p,attempt:3,throttleWait:300,events:$};let _=b(u,e.throttleWait);function m(t,a){t._lazy.arg===Z?t.style.backgroundImage=`url(${a})`:t.setAttribute("src",a)}function q(t){t._lazy.loading&&m(t,t._lazy.loading),u()}function H(t){t._lazy.error&&m(t,t._lazy.error),t._lazy.state="error",A(t),u()}function I(t,a){m(t,a),t._lazy.state="success",A(t),u()}function K(t){d.includes(t)||(d.push(t),e.events?.forEach(a=>{t.addEventListener(a,_,{passive:!0})}))}function X(){d.forEach(t=>{e.events?.forEach(a=>{t.removeEventListener(a,_)})}),d.length=0}function J(t,a){const n={loading:t.getAttribute(F)??e.loading,error:t.getAttribute(Q)??e.error,attempt:t.getAttribute(v)?Number(t.getAttribute(v)):e.attempt};t._lazy={src:a.value,arg:a.arg,currentAttempt:0,state:"pending",attemptLock:!1,...n},m(t,p),W(e.filter,t._lazy)}function tt(t,a){const n=new Image;n.src=a,t._lazy.preloadImage=n,n.addEventListener("load",()=>{t._lazy.attemptLock=!1,w.add(a),I(t,a)}),n.addEventListener("error",()=>{t._lazy.attemptLock=!1,t._lazy.currentAttempt>=t._lazy.attempt?H(t):x(t)})}function x(t){if(t._lazy.attemptLock)return;t._lazy.attemptLock=!0,t._lazy.currentAttempt++;const{src:a}=t._lazy;if(w.has(a)){I(t,a),t._lazy.attemptLock=!1;return}q(t),tt(t,a)}async function f(t){await S(),j(t)&&x(t)}function u(){l.forEach(t=>f(t))}async function at(t){!l.includes(t)&&l.push(t),M(t).forEach(K),await f(t)}function A(t){O(l,t),l.length===0&&X()}function et(t,a){const{src:n,arg:g}=t._lazy;return n!==a.value||g!==a.arg}async function N(t,a){J(t,a),await at(t)}async function nt(t,a){if(!et(t,a)){l.includes(t)&&await f(t);return}await N(t,a)}function st(t={}){const{events:a,loading:n,error:g,attempt:B,throttleWait:C,filter:R}=t;e.events=a??e.events,e.loading=n??e.loading,e.error=g??e.error,e.attempt=B??e.attempt,e.throttleWait=C??e.throttleWait,e.filter=R}const r={mounted:N,unmounted:A,updated:nt,install(t,a){st(a),_=b(u,e.throttleWait),t.directive("lazy",this)}},ot={basicUsage:"Basic Usage",backgroundImageLazyLoad:"Background Image Lazy Load"},ct={basicUsage:"基本使用",backgroundImageLazyLoad:"背景图懒加载"},{add:U,use:rt,t:k,merge:ht}=i.useLocale(),it=t=>{i.use(t),rt(t)};i.add("zh-CN",i.zhCN);i.add("en-US",i.enUS);U("zh-CN",ct);U("en-US",ot);const lt={class:"lazy-example-cat"},ut={class:"lazy-example-cat"},dt={class:"lazy-example-cat"},mt={class:"lazy-example-cat"},gt={class:"lazy-example-cat"},pt={class:"lazy-example-cat"},_t={__name:"index",setup(t){return D(it),(a,n)=>(P(),G(V,null,[y(s(E),null,{default:z(()=>[h(L(s(k)("basicUsage")),1)]),_:1}),o(c("img",lt,null,512),[[s(r),"cat.jpg"]]),o(c("img",ut,null,512),[[s(r),"cat.jpg"]]),o(c("img",dt,null,512),[[s(r),"cat.jpg"]]),o(c("img",mt,null,512),[[s(r),"cat.jpg"]]),o(c("img",gt,null,512),[[s(r),"cat.jpg"]]),y(s(E),null,{default:z(()=>[h(L(s(k)("backgroundImageLazyLoad")),1)]),_:1}),o(c("div",pt,null,512),[[s(r),"cat.jpg","background-image"]])],64))}},Lt=T(_t,[["__scopeId","data-v-9213fca7"]]);export{Lt as default};
